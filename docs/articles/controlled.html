<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How the dea_controlled file was made. • DOPE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How the dea_controlled file was made.">
<meta property="og:description" content="DOPE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DOPE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intro.html">Introduction to DOPE</a>
    </li>
    <li>
      <a href="../articles/controlled.html">How the dea_controlled file was made.</a>
    </li>
    <li>
      <a href="../articles/dea_scrape.html">Scraping drug names and slang from web pages.</a>
    </li>
    <li>
      <a href="../articles/dea_street_names.html">How the dea_street_names file was made.</a>
    </li>
    <li>
      <a href="../articles/make_lookup_df.html">Make Lookup Table</a>
    </li>
    <li>
      <a href="../articles/noslang_street_names.html">How the noslang_stret_names file was made.</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="controlled_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How the dea_controlled file was made.</h1>
            
      
      
      <div class="hidden name"><code>controlled.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">DOPE</span><span class="op">)</span></pre></div>
<p>c_cs_alpha.pdf downloaded <a href="https://www.deadiversion.usdoj.gov/schedules/orangebook/c_cs_alpha.pdf" class="uri">https://www.deadiversion.usdoj.gov/schedules/orangebook/c_cs_alpha.pdf</a> 2020-09-08</p>
<p>The text file, c_cs_alpha.txt, was opened with UltraEdit and edited to remove headers and the data were aligned to match the drug number column. That manual editing to remove the headers should be done programmatically (perhaps with a package that emulates PERL). Aligning of the drug number column is a major coding task given the structure of the data.</p>
<p>That file was opened in Excel to spit into columns. This should be redone in R.</p>
<table class="table">
<thead><tr class="header">
<th>What</th>
<th>Column</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Substance</td>
<td>1-59</td>
</tr>
<tr class="even">
<td>DEA Number</td>
<td>60-62</td>
</tr>
<tr class="odd">
<td>CSA Schedule</td>
<td>63-71</td>
</tr>
<tr class="even">
<td>Narcotic</td>
<td>72</td>
</tr>
<tr class="odd">
<td>Other Names</td>
<td>73+</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span>
<span class="va">controlled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"../inst/extdata/c_cs_alpha.xlsx"</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-lib/conflicted">conflicted</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/conflicted/man/conflict_prefer.html">conflict_prefer</a></span><span class="op">(</span><span class="st">"filter"</span>, <span class="st">"dplyr"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org">stringr</a></span><span class="op">)</span>  <span class="co"># str_count &amp; str_detect</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>  <span class="co"># separate</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org">readr</a></span><span class="op">)</span>  <span class="co"># write_csv</span></pre></div>
<div id="mark-names-that-will-be-diffcult-to-parse" class="section level1">
<h1 class="hasAnchor">
<a href="#mark-names-that-will-be-diffcult-to-parse" class="anchor"></a>Mark names that will be diffcult to parse</h1>
<p>The Names column can have many different synonyms for a drug (street and/or brand). I am marking names records that have an open parenthisis <code>(</code> or a comma followed by something other than a space as being difficult to parse.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="va">new</span> <span class="op">&lt;-</span> <span class="va">controlled</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>difficult <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_count.html">str_count</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">"[(]"</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">|</span> 
           <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">controlled</span><span class="op">$</span><span class="va">Names</span>, <span class="st">",(?=\\S)"</span><span class="op">)</span><span class="op">)</span></pre></div>
</div>
<div id="difficult-synonyms" class="section level1">
<h1 class="hasAnchor">
<a href="#difficult-synonyms" class="anchor"></a><em>Difficult</em> synonyms</h1>
<p>Here the difficult names are exported to a text file and then parsed by to separate names with semi-colons. Check the git history for a partial solution that automated this for specific types complexities.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="co"># filtered rows where synonyms are "difficult"</span>
<span class="va">difficult</span> <span class="op">&lt;-</span> <span class="va">new</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">difficult</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># created an text file (CSV) for all rows with "difficult" synonyms</span>
<span class="co"># difficult %&gt;% </span>
<span class="co"># select(- difficult) %&gt;% </span>
<span class="co">#  write_csv("../inst/extdata/Difficult.csv")</span>

<span class="co"># for the 'difficult' synonyms, I plan to split by semicolon</span>
<span class="co"># prepped csv file for splitting synonyms via semicolon</span>
<span class="va">synonyms_edited</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"../inst/extdata/Difficult_Edited.csv"</span><span class="op">)</span>

<span class="co"># data set of difficult synonyms, all split by semicolon</span>
<span class="va">synonyms_difficult</span> <span class="op">&lt;-</span> 
  <span class="va">synonyms_edited</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span>
    <span class="va">Names</span>, 
    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n_1"</span>, <span class="st">"n_2"</span>, <span class="st">"n_3"</span>, <span class="st">"n_4"</span>, <span class="st">"n_5"</span>, <span class="st">"n_6"</span>, <span class="st">"n_7"</span>, <span class="st">"n_8"</span>, <span class="st">"n_9"</span><span class="op">)</span>, 
    extra <span class="op">=</span> <span class="st">"drop"</span>, 
    fill <span class="op">=</span> <span class="st">"right"</span>, 
    sep <span class="op">=</span> <span class="st">"[;]"</span>, 
    remove <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"n_"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"n_"</span><span class="op">)</span>, 
    values_to <span class="op">=</span> <span class="st">"synonym"</span>, 
    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">Names</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">synonym</span> <span class="op">!=</span> <span class="st">''</span><span class="op">)</span> </pre></div>
</div>
<div id="easy-synonyms" class="section level1">
<h1 class="hasAnchor">
<a href="#easy-synonyms" class="anchor"></a><em>Easy</em> synonyms</h1>
<p>A few of the “easy” synonyms had conjunctions (and/or) or commas without spaces.</p>
<p>For the ‘easy’ synonyms, I plan to split by comma. Below are the records which need modification:</p>
<ul>
<li>row #6: change semicolon to comma</li>
<li>row #58: remove “has been sold as Ecstasy, i.e.”</li>
<li>row #64: change semicolon to comma</li>
<li>row #247: replace “and” with a comma</li>
<li>row #274: replace “and” with a comma</li>
<li>row #328: replace “or” with a comma</li>
<li>row #376: remove comma after synonym name</li>
<li>row #378: change semicolon to comma</li>
<li>row #422: replace “and” with a comma</li>
<li>row #423: replace “and” with a comma</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="co"># filtered rows where synonyms are NOT "difficult"</span>
<span class="va">easy</span> <span class="op">&lt;-</span> <span class="va">new</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">difficult</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>

<span class="co"># made the comma replacements and created a dataset for each type of </span>
<span class="co"># transformation, with the final result being a comma</span>

<span class="co"># change semicolon to comma</span>
<span class="va">semi_is_gone</span> <span class="op">&lt;-</span> 
  <span class="va">easy</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">64</span>, <span class="fl">80</span>, <span class="fl">378</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">";"</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span>

<span class="co"># replace "and" with comma</span>
<span class="va">and_is_gone</span> <span class="op">&lt;-</span>
  <span class="va">easy</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">79</span>, <span class="fl">120</span>, <span class="fl">247</span>, <span class="fl">274</span>, <span class="fl">422</span>, <span class="fl">423</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">" and"</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span>

<span class="co"># remove the phrase involving ecstasy</span>
<span class="va">ecstasy_is_gone</span> <span class="op">&lt;-</span>
  <span class="va">easy</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">58</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">" has been sold as Ecstasy, i.e."</span><span class="op">)</span><span class="op">)</span>

<span class="co"># remove comma after synonym</span>
<span class="va">extra_comma_is_gone</span> <span class="op">&lt;-</span>
  <span class="va">easy</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">376</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span>

<span class="co"># replace "or" with comma</span>
<span class="va">or_is_gone</span> <span class="op">&lt;-</span>
  <span class="va">easy</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">328</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>Names <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="va">Names</span>, <span class="st">" or"</span>, <span class="st">","</span><span class="op">)</span><span class="op">)</span>

<span class="co"># dataset of rows that did NOT require a comma change </span>
<span class="co">#  (i.e. I left them the way they are)  </span>
<span class="va">easy_nochanges</span> <span class="op">&lt;-</span>
  <span class="va">easy</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">58</span>, <span class="op">-</span><span class="fl">64</span>, <span class="op">-</span><span class="fl">79</span>, <span class="op">-</span><span class="fl">80</span>, <span class="op">-</span><span class="fl">120</span>, <span class="op">-</span><span class="fl">247</span>, <span class="op">-</span><span class="fl">274</span>, <span class="op">-</span><span class="fl">328</span>, <span class="op">-</span><span class="fl">376</span>, <span class="op">-</span><span class="fl">378</span>, <span class="op">-</span><span class="fl">422</span>, <span class="op">-</span><span class="fl">423</span><span class="op">)</span>

<span class="co"># bind rows that required a comma change and rows that didn't </span>
<span class="co"># now the data is ready to be split by comma </span>
<span class="va">synonyms_easy_prep</span> <span class="op">&lt;-</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
    <span class="va">semi_is_gone</span>,
    <span class="va">and_is_gone</span>,
    <span class="va">ecstasy_is_gone</span>,
    <span class="va">extra_comma_is_gone</span>,
    <span class="va">or_is_gone</span>,
    <span class="va">easy_nochanges</span>
  <span class="op">)</span>

<span class="co"># dataset of easy synonyms, all split by comma</span>
<span class="va">synonyms_easy</span> <span class="op">&lt;-</span>
  <span class="va">synonyms_easy_prep</span> <span class="op">%&gt;%</span>
  <span class="co"># move the comma separated names into their own columns. </span>
  <span class="co">#   mine new columns are enough to hold the drugs with MANY synonyms.</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span>
    <span class="va">Names</span>, 
    into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"n_1"</span>, <span class="st">"n_2"</span>, <span class="st">"n_3"</span>, <span class="st">"n_4"</span>, <span class="st">"n_5"</span>, <span class="st">"n_6"</span>, <span class="st">"n_7"</span>, <span class="st">"n_8"</span>, <span class="st">"n_9"</span><span class="op">)</span>, 
    extra <span class="op">=</span> <span class="st">"drop"</span>, 
    fill <span class="op">=</span> <span class="st">"right"</span>, 
    sep <span class="op">=</span> <span class="st">"[,]"</span>, 
    remove <span class="op">=</span> <span class="cn">FALSE</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># remove extra spaces for all the newly created variables</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"n_"</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_trim.html">str_trim</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="co"># make the dataset long</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>
    cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"n_"</span><span class="op">)</span>, 
    values_to <span class="op">=</span> <span class="st">"synonym"</span>, 
    values_drop_na <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">Names</span>, <span class="va">difficult</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="co"># get of any blank name columns</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">synonym</span> <span class="op">!=</span> <span class="st">''</span><span class="op">)</span> </pre></div>
</div>
<div id="bind-the-easy-and-difficult-synonym-datasets-to-create-the-final-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#bind-the-easy-and-difficult-synonym-datasets-to-create-the-final-dataset" class="anchor"></a>bind the ‘easy’ and ‘difficult’ synonym datasets to create the final dataset</h1>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="va">dea_controlled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">synonyms_difficult</span>, <span class="va">synonyms_easy</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>synonym <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">synonym</span> <span class="op">==</span> <span class="st">"Soneryl (UK)"</span>, <span class="st">"Soneryl"</span>, <span class="va">synonym</span><span class="op">)</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"substance"</span> <span class="op">=</span> <span class="va">SUBSTANCE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"number"</span> <span class="op">=</span> <span class="va">Number</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"schedule"</span> <span class="op">=</span> <span class="va">Schedule</span><span class="op">)</span>  <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="st">"narcotic"</span> <span class="op">=</span> <span class="va">Narcotic</span><span class="op">)</span>  

<span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_data.html">use_data</a></span><span class="op">(</span><span class="va">dea_controlled</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Raymond Balise, Layla Bouzoubaa, Gabriel Odom.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
